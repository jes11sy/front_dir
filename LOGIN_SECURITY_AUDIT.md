# üîí Security Audit: –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ª–æ–≥–∏–Ω–∞

**–î–∞—Ç–∞:** 31 –æ–∫—Ç—è–±—Ä—è 2025  
**–§–∞–π–ª:** `src/app/login/page.tsx`  
**–°—Ç–∞—Ç—É—Å:** –ù–∞–π–¥–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

---

## üìä –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: 6.5/10

### ‚úÖ –ß—Ç–æ —É–∂–µ –∑–∞—â–∏—â–µ–Ω–æ:

1. **Sanitization –ª–æ–≥–∏–Ω–∞** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `sanitizeString()` ‚úÖ
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª–µ–π** - –µ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã –∏ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ ‚úÖ
3. **HTTPS** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `https://api.test-shem.ru` ‚úÖ
4. **X-Frame-Options** - –∑–∞—â–∏—Ç–∞ –æ—Ç clickjacking ‚úÖ
5. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π autocomplete** - `username` –∏ `current-password` ‚úÖ
6. **Disabled –∫–Ω–æ–ø–∫–∞** - –Ω–µ–ª—å–∑—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –ø–æ–¥—Ä—è–¥ ‚úÖ

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò

### 1. ‚ö†Ô∏è XSS —á–µ—Ä–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö –≤–∞–ª–∏–¥–∞—Ü–∏–∏

**–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å:** –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø  
**–†–∏—Å–∫:** –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ –∫–æ–¥–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript:116:118:c:/Users/–ú–ê–†–¢–ê/Desktop/kuber/frontend dir/src/app/login/page.tsx
{errors.login && (
  <p className="text-red-500 text-sm mt-1 animate-fade-in">{errors.login}</p>
)}
```

–°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ –≤—ã–≤–æ–¥–∏—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –±–µ–∑ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏–∏! –ï—Å–ª–∏ –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ —Å–æ–∑–¥–∞—Å—Ç –∫–∞—Å—Ç–æ–º–Ω—É—é –æ—à–∏–±–∫—É —Å HTML/JS –∫–æ–¥–æ–º, –æ–Ω–∞ –±—É–¥–µ—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∞.

**–í–µ–∫—Ç–æ—Ä—ã –∞—Ç–∞–∫–∏:**
1. –ú–æ–¥–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –º–æ–∂–µ—Ç –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω—É—é –æ—à–∏–±–∫—É
2. Man-in-the-middle –º–æ–∂–µ—Ç –∏–∑–º–µ–Ω–∏—Ç—å –æ—Ç–≤–µ—Ç —Å–µ—Ä–≤–µ—Ä–∞
3. Compromised backend –º–æ–∂–µ—Ç –≤–µ—Ä–Ω—É—Ç—å XSS –≤ —Å–æ–æ–±—â–µ–Ω–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
–°–∞–Ω–∏—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å –í–°–ï –≤—ã–≤–æ–¥–∏–º—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö.

---

### 2. ‚ö†Ô∏è –°–ª–∞–±—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ –ø–∞—Ä–æ–ª—é

**–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å:** –í–´–°–û–ö–ê–Ø  
**–†–∏—Å–∫:** –õ–µ–≥–∫–∏–π –ø–æ–¥–±–æ—Ä –ø–∞—Ä–æ–ª–µ–π

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript:43:47:c:/Users/–ú–ê–†–¢–ê/Desktop/kuber/frontend dir/src/app/login/page.tsx
const passwordError = validateField(sanitizedPassword, [
  validators.required('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å'),
  validators.minLength(4, '–ü–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π'), // ‚ö†Ô∏è –í–°–ï–ì–û 4 –°–ò–ú–í–û–õ–ê!
  validators.maxLength(100, '–ü–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º –¥–ª–∏–Ω–Ω—ã–π'),
])
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –æ–ø–∞—Å–Ω–æ:**
- –ü–∞—Ä–æ–ª—å –∏–∑ 4 —Å–∏–º–≤–æ–ª–æ–≤ = —Ç–æ–ª—å–∫–æ –±—É–∫–≤—ã = 26^4 = ~456,976 –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
- –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π GPU –ø–µ—Ä–µ–±–∏—Ä–∞–µ—Ç —ç—Ç–æ –∑–∞ **—Å–µ–∫—É–Ω–¥—ã**
- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –º–∏–Ω–∏–º—É–º: **12 —Å–∏–º–≤–æ–ª–æ–≤**

**–ü—Ä–∏–º–µ—Ä—ã —Å–ª–∞–±—ã—Ö –ø–∞—Ä–æ–ª–µ–π:**
- `pass` ‚úÖ –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é!
- `1234` ‚úÖ –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é!
- `test` ‚úÖ –ø—Ä–æ—Ö–æ–¥–∏—Ç –≤–∞–ª–∏–¥–∞—Ü–∏—é!

---

### 3. ‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ Rate Limiting –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

**–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å:** –í–´–°–û–ö–ê–Ø  
**–†–∏—Å–∫:** –ë—Ä—É—Ç—Ñ–æ—Ä—Å –∞—Ç–∞–∫–∏

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞. –ó–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –º–æ–∂–µ—Ç:
- –ü–µ—Ä–µ–±–∏—Ä–∞—Ç—å –ø–∞—Ä–æ–ª–∏ –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- DoS –∞—Ç–∞–∫–∞ –Ω–∞ API –ª–æ–≥–∏–Ω–∞
- –ü–æ–¥–±–æ—Ä —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–î–æ–±–∞–≤–∏—Ç—å throttling: –º–∞–∫—Å–∏–º—É–º 5 –ø–æ–ø—ã—Ç–æ–∫ –∑–∞ 5 –º–∏–Ω—É—Ç.

---

### 4. ‚ö†Ô∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

**–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å:** –°–†–ï–î–ù–Ø–Ø  
**–†–∏—Å–∫:** –ü–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (User Enumeration)

**–ü—Ä–æ–±–ª–µ–º–∞:**
–î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ø–æ–º–æ–≥–∞—é—Ç –∞—Ç–∞–∫—É—é—â–µ–º—É:

```typescript
validators.minLength(2, '–õ–æ–≥–∏–Ω —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π')  // –†–∞—Å–∫—Ä—ã–≤–∞–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
validators.minLength(4, '–ü–∞—Ä–æ–ª—å —Å–ª–∏—à–∫–æ–º –∫–æ—Ä–æ—Ç–∫–∏–π')  // –ü–æ–º–æ–≥–∞–µ—Ç –ø–æ–¥–±–∏—Ä–∞—Ç—å –ø–∞—Ä–æ–ª—å
```

–ï—Å–ª–∏ backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–∞–∑–Ω—ã–µ –æ—à–∏–±–∫–∏ –¥–ª—è "–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω" vs "–Ω–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å", –∞—Ç–∞–∫—É—é—â–∏–π –º–æ–∂–µ—Ç –ø–µ—Ä–µ—á–∏—Å–ª–∏—Ç—å –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–û–±—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ: "–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å"

---

### 5. ‚ö†Ô∏è –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CAPTCHA

**–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å:** –°–†–ï–î–ù–Ø–Ø  
**–†–∏—Å–∫:** –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∞—Ç–∞–∫–∏ –±–æ—Ç–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ù–µ—Ç –∑–∞—â–∏—Ç—ã –æ—Ç:
- –ë–æ—Ç–æ–≤ –¥–ª—è –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- DDoS –Ω–∞ —Ñ–æ—Ä–º—É –ª–æ–≥–∏–Ω–∞

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–î–æ–±–∞–≤–∏—Ç—å reCAPTCHA v3 (–Ω–µ–≤–∏–¥–∏–º–∞—è) –ø–æ—Å–ª–µ 3 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫.

---

### 6. ‚ö†Ô∏è Timing Attack –≤–æ–∑–º–æ–∂–µ–Ω

**–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å:** –ù–ò–ó–ö–ê–Ø-–°–†–ï–î–ù–Ø–Ø  
**–†–∏—Å–∫:** –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ü—Ä–æ–±–ª–µ–º–∞:**
–ï—Å–ª–∏ backend –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–∞—Ä–æ–ª—å —Ç–æ–ª—å–∫–æ –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –±—É–¥–µ—Ç —Ä–∞–∑–Ω—ã–º:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ù–ï —Å—É—â–µ—Å—Ç–≤—É–µ—Ç: –±—ã—Å—Ç—Ä—ã–π –æ—Ç–≤–µ—Ç (~50ms)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç, –ø–∞—Ä–æ–ª—å –Ω–µ–≤–µ—Ä–Ω—ã–π: –º–µ–¥–ª–µ–Ω–Ω–µ–µ (~200ms –∏–∑-–∑–∞ bcrypt)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
–ù–∞ backend –≤—Å–µ–≥–¥–∞ –¥–µ–ª–∞—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Ä–∞–±–æ—Ç—É (dummy hash check).

---

### 7. ‚ö†Ô∏è –ù–µ–∑–∞—â–∏—â–µ–Ω–Ω—ã–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞

**–°–µ—Ä—å–µ–∑–Ω–æ—Å—Ç—å:** –ù–ò–ó–ö–ê–Ø  
**–†–∏—Å–∫:** Open Redirect

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript:68:68:c:/Users/–ú–ê–†–¢–ê/Desktop/kuber/frontend dir/src/app/login/page.tsx
router.push('/orders')
```

–ï—Å–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `?redirect=`, –º–æ–∂–Ω–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –≤–Ω–µ—à–Ω–∏–π —Å–∞–π—Ç:
```
https://yoursite.com/login?redirect=https://evil.com
```

**–†–µ—à–µ–Ω–∏–µ:**
–í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å redirect —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ URL.

---

## üü° –°–†–ï–î–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´

### 8. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ 2FA (Two-Factor Authentication)

–î–ª—è CRM —Å —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è.

### 9. –ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—Ç–µ—á–∫–∏ –ø–∞—Ä–æ–ª—è

–ú–æ–∂–Ω–æ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å API `haveibeenpwned.com` –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π.

### 10. –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è –≤ "–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è"

Checkbox "–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è" –∏—Å–ø–æ–ª—å–∑—É–µ—Ç localStorage - —É—è–∑–≤–∏–º–æ—Å—Ç—å –∫ XSS (—É–∂–µ –∏—Å–ø—Ä–∞–≤–∏–ª–∏ –Ω–∞ sessionStorage ‚úÖ).

---

## üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 1: –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö

```typescript
// –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤—ã–≤–æ–¥ –æ—à–∏–±–æ–∫
{errors.login && (
  <p className="text-red-500 text-sm mt-1 animate-fade-in">
    {sanitizeString(errors.login)}
  </p>
)}

{errors.password && (
  <p className="text-red-500 text-sm mt-1 animate-fade-in">
    {sanitizeString(errors.password)}
  </p>
)}
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 2: –£—Å–∏–ª–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –ø–∞—Ä–æ–ª—é

```typescript
const passwordError = validateField(sanitizedPassword, [
  validators.required('–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å'),
  validators.minLength(8, '–ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤'),  // –£–≤–µ–ª–∏—á–∏–ª–∏ —Å 4 –¥–æ 8
  validators.maxLength(100, '–ú–∞–∫—Å–∏–º—É–º 100 —Å–∏–º–≤–æ–ª–æ–≤'),
  // –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  validators.pattern(
    /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,
    '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –∑–∞–≥–ª–∞–≤–Ω—ã–µ –∏ —Å—Ç—Ä–æ—á–Ω—ã–µ –±—É–∫–≤—ã, —Ü–∏—Ñ—Ä—ã'
  ),
])
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 3: Rate Limiting

```typescript
// –î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
const [attemptCount, setAttemptCount] = useState(0)
const [blockedUntil, setBlockedUntil] = useState<number | null>(null)

const handleSubmit = async (e: React.FormEvent) => {
  e.preventDefault()
  
  // –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
  if (blockedUntil && Date.now() < blockedUntil) {
    const seconds = Math.ceil((blockedUntil - Date.now()) / 1000)
    toast.error(`–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ ${seconds} —Å–µ–∫—É–Ω–¥`)
    return
  }
  
  setIsLoading(true)
  setErrors({})
  
  try {
    // ... –≤–∞–ª–∏–¥–∞—Ü–∏—è ...
    
    const data = await apiClient.login(sanitizedLogin, sanitizedPassword, rememberMe)
    
    // –£—Å–ø–µ—à–Ω—ã–π –≤—Ö–æ–¥ - —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
    setAttemptCount(0)
    setBlockedUntil(null)
    
    router.push('/orders')
  } catch (error) {
    // –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
    const newCount = attemptCount + 1
    setAttemptCount(newCount)
    
    // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø–æ—Å–ª–µ 5 –ø–æ–ø—ã—Ç–æ–∫
    if (newCount >= 5) {
      const blockTime = Date.now() + 5 * 60 * 1000 // 5 –º–∏–Ω—É—Ç
      setBlockedUntil(blockTime)
      toast.error('–°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ 5 –º–∏–Ω—É—Ç.')
    } else {
      const remainingAttempts = 5 - newCount
      toast.error(
        `–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å. –û—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫: ${remainingAttempts}`
      )
    }
    
    setIsLoading(false)
  }
}
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 4: –û–±—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

```typescript
// –í–º–µ—Å—Ç–æ –¥–µ—Ç–∞–ª—å–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
if (loginError || passwordError) {
  // ‚ùå –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏!
  // toast.error(loginError || passwordError)
  
  // ‚úÖ –û–±—â–µ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
  toast.error('–ù–µ–≤–µ—Ä–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –≤—Ö–æ–¥–∞')
  setIsLoading(false)
  return
}
```

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ 5: –ó–∞—â–∏—Ç–∞ –æ—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç–∞

```typescript
import { useSearchParams } from 'next/navigation'

const searchParams = useSearchParams()
const redirect = searchParams.get('redirect')

// –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—Ö–æ–¥–∞
if (redirect && redirect.startsWith('/') && !redirect.startsWith('//')) {
  // –¢–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ URL (–Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å /)
  router.push(redirect)
} else {
  router.push('/orders')
}
```

---

## üéØ –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—Å–¥–µ–ª–∞—Ç—å –°–†–û–ß–ù–û):
1. ‚úÖ –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö (XSS)
2. ‚úÖ –£–≤–µ–ª–∏—á–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É –ø–∞—Ä–æ–ª—è –¥–æ 8
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å rate limiting –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—Å–¥–µ–ª–∞—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ–¥–µ–ª–∏):
4. –î–æ–±–∞–≤–∏—Ç—å CAPTCHA –ø–æ—Å–ª–µ 3 –ø–æ–ø—ã—Ç–æ–∫
5. –û–±—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö (–Ω–µ —Ä–∞—Å–∫—Ä—ã–≤–∞—Ç—å –¥–µ—Ç–∞–ª–∏)
6. –ó–∞—â–∏—Ç–∞ –æ—Ç open redirect

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–º–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å):
7. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ø–∞—Ä–æ–ª—è
8. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å haveibeenpwned
9. Timing attack –∑–∞—â–∏—Ç–∞ –Ω–∞ backend

---

## üìã Backend Security Checklist

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞ backend:**

- [ ] SQL Injection –∑–∞—â–∏—Ç–∞ (prepared statements)
- [ ] Rate limiting (–º–∞–∫—Å–∏–º—É–º 5 –ø–æ–ø—ã—Ç–æ–∫ / IP / 5 –º–∏–Ω—É—Ç)
- [ ] –ó–∞—â–∏—Ç–∞ –æ—Ç timing attacks (constant-time comparison)
- [ ] –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (bcrypt —Å cost >= 12)
- [ ] –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
- [ ] Account lockout –ø–æ—Å–ª–µ N –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
- [ ] CSRF —Ç–æ–∫–µ–Ω—ã –¥–ª—è API
- [ ] Secure cookies (HttpOnly, Secure, SameSite)
- [ ] –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –Ω–∞ backend (–Ω–µ –¥–æ–≤–µ—Ä—è—Ç—å —Ñ—Ä–æ–Ω—Ç—É!)

---

## üìä –ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –û—Ü–µ–Ω–∫–∞ | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π |
|-----------|--------|-------------|
| **XSS –∑–∞—â–∏—Ç–∞** | 6/10 | –ï—Å—Ç—å —Å–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è, –Ω–æ –Ω–µ –≤–µ–∑–¥–µ |
| **SQL Injection** | 10/10 | –ù–∞ —Ñ—Ä–æ–Ω—Ç–µ –Ω–µ –ø—Ä–∏–º–µ–Ω–∏–º–æ (backend –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å) |
| **Rate Limiting** | 2/10 | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç |
| **Password Security** | 3/10 | –°–ª–∏—à–∫–æ–º —Å–ª–∞–±—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (4 —Å–∏–º–≤–æ–ª–∞) |
| **User Enumeration** | 5/10 | –î–µ—Ç–∞–ª—å–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è |
| **CAPTCHA** | 0/10 | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç |
| **CSRF** | 8/10 | SameSite cookies (–µ—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã) |
| **Clickjacking** | 10/10 | X-Frame-Options: DENY ‚úÖ |

---

## ‚úÖ –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

### –ù–µ–¥–µ–ª—è 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏
- [x] CSP –¥–æ–±–∞–≤–ª–µ–Ω ‚úÖ
- [x] sessionStorage –≤–º–µ—Å—Ç–æ localStorage ‚úÖ
- [ ] –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π –æ–± –æ—à–∏–±–∫–∞—Ö
- [ ] –£–≤–µ–ª–∏—á–∏—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω—É—é –¥–ª–∏–Ω—É –ø–∞—Ä–æ–ª—è
- [ ] –î–æ–±–∞–≤–∏—Ç—å rate limiting

### –ù–µ–¥–µ–ª—è 2: –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç
- [ ] –î–æ–±–∞–≤–∏—Ç—å CAPTCHA
- [ ] –û–±—â–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- [ ] –ó–∞—â–∏—Ç–∞ –æ—Ç open redirect

### –ù–µ–¥–µ–ª—è 3: Backend
- [ ] –ê—É–¥–∏—Ç backend API
- [ ] Rate limiting –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- [ ] Account lockout
- [ ] Security logging

---

## üö® –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è

**–°–ï–ô–ß–ê–° –Ω—É–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å:**

1. **XSS –≤ –æ—à–∏–±–∫–∞—Ö** - 5 –º–∏–Ω—É—Ç
2. **–°–ª–∞–±—ã–π –ø–∞—Ä–æ–ª—å** - 2 –º–∏–Ω—É—Ç—ã
3. **Rate limiting** - 15 –º–∏–Ω—É—Ç

**–ò—Ç–æ–≥–æ:** 22 –º–∏–Ω—É—Ç—ã –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π!

---

**–ê–≤—Ç–æ—Ä –∞—É–¥–∏—Ç–∞:** AI Security Analyst  
**–î–∞—Ç–∞:** 31 –æ–∫—Ç—è–±—Ä—è 2025

